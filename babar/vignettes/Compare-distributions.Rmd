<link rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/monokai.min.css">
<!--
%\VignetteEngine{knitr::docco_linear}
%\VignetteIndexEntry{Comparing distributions using nested sampling}
-->

```{r setup, include=FALSE}
inline_hook <- function(x) {
    if(is.numeric(x)) x <- round(x, 2)
    paste(as.character(x), collapse=", ")
}
knit_hooks$set(inline = inline_hook)

## options(width=65, reindent.spaces = 2)
```

# Comparing distributions using nested sampling

A common problem in the analysis of experimental data is deciding between two
hypothesis (or models) for a set of data. 

## Generating example data

Let's first generate some example data. We first set the number of samples:

```{r}
n.samples <- 500
```

Then we create samples from two normal distributions, with different means and 
the same standard deviation.

```{r}
sd.a <- 2
mean.a <- 0
data.a <- rnorm(n.samples, mean.a, sd.a)

sd.b <- 2
mean.b <- 1
data.b <- rnorm(n.samples, mean.b, sd.b)
```

## Nested sampling

First we source the necessary files:

```{r sourcingScripts}
## Assuming you're in the vignettes/ directory. If not adjust these source arguments appropriately
  source("../R/nested.R")
  source("../R/params2priors.R")
```

### Log likelihood function

Next we construct a function to generate log likelihoods:

```{r generateLLfuncs}
llfMaker <- function(data) {
  llf <- function(params) {
    mean = params[1]
    sigma = params[2]

    n <- length(data)

    ll <- -n * log(sigma) -(1 / (2 * sigma ** 2)) * sum((data - mean) ** 2)

    return(ll)
  }

  return(llf)
}
```

Then set the prior size:

```{r setpriorsize}
prior.size <- 100
```

Then we perform the nested sampling:

```{r firstNS}
tol = 0.5
llf.a <- llfMaker(data.a)

ret <- nestedSampling(llf.a, 2, prior.size, , exploreFn=ballExplore, tolerance=tol)
```

